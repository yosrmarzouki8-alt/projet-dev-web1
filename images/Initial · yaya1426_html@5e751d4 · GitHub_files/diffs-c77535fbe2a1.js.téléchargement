"use strict";(globalThis.webpackChunk_github_ui_github_ui=globalThis.webpackChunk_github_ui_github_ui||[]).push([[45345],{10022:(e,t,n)=>{n.d(t,{U:()=>o});var r=n(53627);function o(e,t,n,s,l,i,a,c,d=window.location.search){let u=document.querySelector(".js-file-filter"),m=new URL(window.location.href,window.location.origin),f=new URLSearchParams(d),g=f.get("w");if(!e&&!s){if(i)return;let e=new URLSearchParams,t=f.get("diff");t&&e.set("diff",t),g&&e.set("w",g),m.search=e.toString(),(0,r.bj)(m.toString());return}let h=new FormData(u.querySelector(".js-file-filter-form")),p=n.filter(e=>!h.getAll("file-filters[]").includes(e)),b=l.filter(e=>!h.getAll("owned-by[]").includes(e));for(let e of p)h.append("file-filters[]",e);for(let e of b)h.append("owned-by[]",e);let y=new URLSearchParams(h);y.has("file-filters[]")&&""!==y.toString()||y.set("file-filters[]",""),t&&y.set("w",g??"1"),i&&y.set("manifests","true"),a&&y.set("show-deleted-files","false"),c&&y.set("show-viewed-files","false"),y.delete("authenticity_token"),m.search=y.toString(),(0,r.bj)(m.toString())}},18962:(e,t,n)=>{var r=n(31635),o=n(39595);let s=class InputDemuxElement extends HTMLElement{connectedCallback(){this.control&&(this.storedInput=Array(this.control.children.length).fill("")),this.addEventListener("input",this.relayInput.bind(this)),this.addEventListener("keydown",this.relayKeydown.bind(this));let e=this.closest("details");e&&e.addEventListener("toggle",()=>{e.open&&this.source.focus()})}relayKeydown(e){if((this.isControlTab(e.target)||e.target===this.source)&&("ArrowDown"===e.key||"Tab"===e.key))e.preventDefault(),e.stopPropagation(),this.routeCustomEvent(new CustomEvent("focus-list"));else if("Escape"===e.key){let e=this.closest("details");e&&e.removeAttribute("open")}}isControlTab(e){return!!e&&!!this.control&&Array.from(this.control.children).includes(e)}relayInput(e){if(!e.target)return;let t=e.target.value;this.routeCustomEvent(new CustomEvent("input-entered",{detail:t}))}routeCustomEvent(e){this.sinks[this.selectedIndex].dispatchEvent(e)}get selectedIndex(){if(!this.control)return 0;let e=this.control.querySelector('[aria-selected="true"]');return e?Array.from(this.control.children).indexOf(e):0}storeInput(){this.storedInput[this.selectedIndex]=this.source.value}updateInput(e){this.source.value=this.storedInput[this.selectedIndex];let t=e.panel?.getAttribute("data-filter-placeholder")||"";this.source.placeholder=t,this.source.setAttribute("aria-label",t),this.notifySelected()}notifySelected(){let e=this.sinks[this.selectedIndex],t=new CustomEvent("tab-selected");e.dispatchEvent(t)}};(0,r.Cg)([o.aC],s.prototype,"source",void 0),(0,r.Cg)([o.zV],s.prototype,"sinks",void 0),(0,r.Cg)([o.aC],s.prototype,"control",void 0),s=(0,r.Cg)([o.p_],s)},39857:(e,t,n)=>{(0,n(21403).lB)("#js-spoofed-commit-warning-trigger",{add:()=>{let e=document.getElementById("spoof-warning");if(!e)return;let t=document.querySelector(".commit-title");t&&t.classList.add("pb-1"),e.hidden=!1,e.removeAttribute("aria-hidden")}})},56971:(e,t,n)=>{n.d(t,{H:()=>l,i:()=>i});var r=n(97797),o=n(2025),s=n(87363);function l(e){let t=e.querySelector(".js-inline-comment-form-container");t.classList.add("open"),t.querySelector(".js-write-tab")?.click(),t.querySelector(".js-comment-field").focus(),(0,r.h)(t,"inlinecomment:focus")}function i(e){e.reset();let t=e.closest(".js-inline-comment-form-container");t.classList.remove("open");let n=t.querySelector(".js-multi-line-preview");n&&(n.hidden=!0),(0,r.h)(t,"inlinecomment:collapse")}(0,r.on)("click",".js-toggle-inline-comment-form",function(e){l(e.currentTarget.closest(".js-line-comments"))}),(0,r.on)("quote-selection",".js-line-comments",function(e){l(e.currentTarget),e.stopPropagation()}),(0,s.Ff)("keydown",".js-inline-comment-form-container form .js-comment-field",function(e){let t=e.target;t.classList.contains("js-navigation-enable")||"Escape"===e.key&&0===t.value.length&&(i(t.closest("form")),e.preventDefault())}),(0,r.on)("click",".js-hide-inline-comment-form",function(e){let t=e.currentTarget.closest("form");!(0,o.Av)(t)||confirm(e.currentTarget.getAttribute("data-confirm-cancel-text"))?i(t):e.preventDefault()})},57001:(e,t,n)=>{let r;var o=n(97797),s=n(1330);(0,o.on)("click",".js-conversation-menu-button",(r=!0,async function(e){if(!1===r){let t=e.currentTarget.closest(".select-menu").querySelector("details-menu");if(!t)return;t.textContent="";let n=`${t.getAttribute("src")}?instrument=1`,r=await fetch(n);r.ok&&(t.innerHTML=await r.text())}r=!1})),(0,o.on)("click",".js-conversations-menu-item",function(e){let t=e.currentTarget,n=t.closest(".js-conversations-details");n.hasAttribute("open")&&n.removeAttribute("open"),window.location.hash=t.hash,(0,s.GO)(document)}),(0,o.on)("click",".js-resolved-conversations",async function(e){var t;let n=e.currentTarget.querySelector(".dropdown-caret"),r=e.currentTarget.querySelector(".select-menu-header");""===(t=n).style.transform?t.style.transform="rotate(180deg)":t.style.transform="",r.classList.toggle("border-bottom-0")});var l=n(96123),i=n(31803),a=n(21403),c=n(10022);function d({currentTarget:e}){let t=e.hasAttribute("open");e.closest(".js-file-header").classList.toggle("has-open-dropdown",t)}function u(){return Array.from(m()).filter(e=>e.checked).map(e=>e.value)}function m(){return document.querySelectorAll(".js-diff-file-type-option")}function f(){let e=document.querySelector(".js-deleted-files-toggle");if(e instanceof HTMLInputElement)return e}function g(){return h().length>0}function h(){return Array.from(document.querySelectorAll(".js-diff-owner-option")).filter(e=>e.checked).map(e=>e.value)}function p(){return u().length!==m().length}function b(){let e=document.querySelector(".js-manifests-option");return!!e&&e.checked}function y(){let e=f();return!!e&&!e.checked}function j(){let e=document.querySelector(".js-viewed-files-toggle");return!!e&&!e.checked}(0,o.on)("details:toggled-group",".js-file.js-details-container",function(e){e.target===e.currentTarget&&function(e){var t,n;let r,o,s,l,i;if(!document.querySelector(".js-file-filter"))return;for(let t of m())t.checked=e;let a=f();a&&(a.checked=!e);let d=p()||y()||j()||g()||b();t=d,document.querySelector(".js-file-filter-text").classList.toggle("color-fg-accent",t),n=d,r=document.querySelector(".js-reset-filters"),o=document.querySelector(".js-commits-filtered"),null==r||o||(r.hidden=!n),function(){let e=m(),t=y();for(let n of e)if(t){let e="0"===n.getAttribute("data-non-deleted-files-count");n.disabled=e}else n.disabled=!1}(),s=p(),i=(l=document.querySelector(".js-file-filter-select-all-container")).getAttribute(s?"data-select-all-markup":"data-all-selected-markup"),l.textContent=i,l.classList.toggle("color-fg-muted",!s),l.classList.toggle("color-fg-accent",s),function(){for(let e of document.querySelectorAll(".js-file-type-count")){let t=y()?"data-non-deleted-file-count-markup":"data-all-file-count-markup",n=e.getAttribute(t);n&&(e.textContent=n)}}(),(0,c.U)(d,new URLSearchParams(window.location.search).has("w"),u(),g(),h(),b(),y(),j())}(e.detail.open)}),(0,o.on)("details:toggled",".js-file.js-details-container",function(e){if(e.target!==e.currentTarget)return;let t=e.currentTarget;t.getBoundingClientRect().top<0&&(0,s.Rt)(t)}),(0,i.A)(()=>{let e=window.location.hash.slice(1);if(!e)return;let t=document.getElementsByName(e)[0];if(!t)return;let n=t.nextElementSibling;n&&n.matches(".js-file.js-details-container")&&(n.classList.add("open"),n.classList.add("Details--on"))}),(0,a.lB)(".js-file-header-dropdown",{subscribe:e=>(0,l.Rt)(e,"toggle",d)}),(0,o.on)("click",".js-jump-to-menu-item",function({currentTarget:e}){let t=e.getAttribute("href").substring(1),n=document.querySelector(`[data-anchor="${t}"]`);n&&(n.closest(".js-file.js-details-container").hidden=!1),function(){let e=document.querySelector(".js-file-filter-blankslate");if(!e)return;if(document.querySelectorAll(".js-diff-progressive-loader").length>0){e.hidden=!0;return}let t=document.querySelectorAll(".js-file");if(0===t.length){e.hidden=!0;return}e.hidden=Array.from(t).some(e=>!e.hidden)}()});var v=n(56971),S=n(27646),q=n(78134),w=n(46865),A=n(90891),L=n(69759),E=n(58371);let C="```suggestion",T=RegExp(`${C}(?:.*)
`,"i"),x=RegExp(`\`\`\`(
|$)`);function k(e,t){let n=e.slice(0,t).split(`
`);return e.split(`
`)[n.length-1]}function _(e){let t=/^(\s+)/.exec(e);return t&&t[0]||""}function F(e,t,n=0){let r=t.substring(n,t.length),o=e.exec(r);return o?o.index+n:-1}function I(e,t){let n=[],r=0,o=-1;for(;(o=F(T,e,r))>-1;){let t=F(x,e,r=o+C.length);if(-1===t)return!1;r=t+3,n.push([o,t])}return n.some(e=>t>e[0]&&t<e[1])}var M=n(87363),H=n(51519),D=n(51987);let B=".js-closed-pull",R=".js-viewing-subset-changes";function $(e,t){let n=document.querySelectorAll(".js-apply-suggestion-button"),r=e.querySelector(".js-disabled-apply-suggestion-button");for(let e of n){let n=r.cloneNode(!0);N(n,t),e.closest("details").replaceWith(n)}}function P(e){let t=document.querySelector(".js-batched-suggested-changes-container");for(let n of(t&&t.classList.add("d-none"),document.querySelectorAll(".js-apply-single-suggestion")))n.classList.remove("d-none"),n.disabled=!0,n.setAttribute("aria-label",e);for(let t of document.querySelectorAll(".js-batched-suggested-changes-add"))t.classList.remove("d-none"),t.disabled=!0,t.setAttribute("aria-label",e);for(let e of document.querySelectorAll(".js-batched-suggested-changes-remove"))e.classList.add("d-none");for(let e of document.querySelectorAll(".js-focus-commit-suggestions-form-button"))e.classList.add("d-none");for(let e of document.querySelectorAll(".js-pending-batched-suggestion-label"))e.classList.add("d-none")}function N(e,t){e.setAttribute("aria-label",t),e.classList.remove("d-none")}function W(e,t,n){e&&(e.setAttribute("disabled","disabled"),e.setAttribute("aria-label",n)),t&&(t.hidden=!0)}function U(e,t){let n=document.querySelector(".js-suggested-changes-inline-validation-template").cloneNode(!0);n.classList.remove("js-suggested-changes-inline-validation-template"),n.querySelector(".js-suggested-changes-inline-error-message").textContent=e.trim(),t.parentNode.insertBefore(n,t.nextSibling)}function z(e){if(!document.querySelector(".js-suggested-changes-subset-files"))return;let t=e.querySelectorAll(".js-suggested-change-toolbar-item");if(!R)return;let n=document.querySelector(R).textContent.trim();for(let e of t){e.setAttribute("aria-disabled","true");let t=e.getAttribute("aria-describedby");if(!t)continue;let r=document.getElementById(t);r&&(r.textContent=n)}}function O(){let e=document.querySelector(".js-batched-suggested-changes-container");e&&setTimeout(()=>(function(e){let t=e.closest(".js-review-state-classes").querySelectorAll("[data-pending-batched-suggestion]").length;for(let e of document.querySelectorAll(".js-pending-batched-suggested-changes-count"))e.textContent=String(t);let n=document.querySelector(".js-reenable-add-to-batch").textContent;for(let e of document.querySelectorAll("[data-batched-suggestion-reenable-sibling]"))e.removeAttribute("data-batched-suggestion-reenable-sibling"),e.removeAttribute("disabled"),e.setAttribute("aria-label",n);if(t>0){e.hidden=!1;let t=e.querySelector(".js-batched-suggested-changes-toggle");for(let e of(t.classList.add("anim-pulse-in"),t.addEventListener("animationend",()=>t.classList.remove("anim-pulse-in"),{once:!0}),document.querySelectorAll(".js-apply-single-suggestion")))e.classList.add("d-none");for(let e of document.querySelectorAll(".js-batched-suggested-changes-add")){let t=e.closest(".js-suggested-change-form-container");"true"===t.getAttribute("data-pending-batched-suggestion")||"true"===t.getAttribute("data-comment-pending")||"true"===t.getAttribute("data-outdated-comment")?e.classList.add("d-none"):e.classList.remove("d-none"),"true"===e.getAttribute("data-batched-suggestion-disabled-by-sibling")&&(e.removeAttribute("data-batched-suggestion-disabled-by-sibling"),e.setAttribute("disabled","disabled"),e.setAttribute("aria-label",document.querySelector(".js-one-suggestion-per-line").textContent))}for(let e of document.querySelectorAll(".js-batched-suggested-changes-remove"))"true"===e.closest(".js-suggested-change-form-container").getAttribute("data-pending-batched-suggestion")?e.classList.remove("d-none"):e.classList.add("d-none");for(let e of document.querySelectorAll(".js-focus-commit-suggestions-form-button")){let t=e.closest(".js-suggested-change-form-container"),n="true"===t.getAttribute("data-comment-pending"),r="true"===t.getAttribute("data-outdated-comment"),o="true"===t.getAttribute("data-resolved-comment"),s="left"===e.closest(".js-inline-comments-container").querySelector('input[name="side"]').value;n||r||o||s?e.classList.add("d-none"):e.classList.remove("d-none")}for(let e of document.querySelectorAll(".js-pending-batched-suggestion-label"))"true"===e.closest(".js-suggested-change-form-container").getAttribute("data-pending-batched-suggestion")?e.classList.remove("d-none"):e.classList.add("d-none")}else{for(let t of(e.hidden=!0,document.querySelectorAll(".js-apply-single-suggestion")))t.classList.remove("d-none");for(let e of document.querySelectorAll(".js-batched-suggested-changes-add"))e.classList.remove("d-none");for(let e of document.querySelectorAll(".js-batched-suggested-changes-remove"))e.classList.add("d-none");for(let e of document.querySelectorAll(".js-focus-commit-suggestions-form-button"))e.classList.add("d-none");for(let e of document.querySelectorAll(".js-pending-batched-suggestion-label"))e.classList.add("d-none")}})(e))}function V(e,t){let n=e.querySelector("input[name=commit_title]"),r=e.querySelector("textarea[name=commit_message]"),o=n.value.trim();""===o&&(o=n.defaultValue);let s=r.value.trim();""!==s&&(o=`${o}

${s}
`),n.disabled=!0,r.disabled=!0;let l=document.createElement("input");l.setAttribute("type","hidden"),l.setAttribute("name","message"),l.value=o,e.appendChild(l);let i=document.createElement("input");i.setAttribute("type","hidden"),i.setAttribute("name","changes"),i.value=JSON.stringify(t),e.appendChild(i)}(0,o.on)("click",".js-suggested-change-toolbar-item",function(e){let t,n=e.currentTarget;n instanceof HTMLButtonElement&&"false"===n.getAttribute("aria-disabled")&&null!=(t=n.getAttribute("data-lines"))&&function(e,t){let n=`${C}
${e}
\`\`\``,r=t.selectionStart,o=t.value,s=F(/\n/,o,r),l=""===o.trim(),i=k(o,r),a=""===i.trim(),c=o,d=0;if(l)d=(c=n).length-4;else if(-1===s)d=a?(c=o+n).length-4:(c=[o,n].join(`
`)).length-4;else if(a){let e=r-_(i).length,t=o.substring(0,e),l=o.substring(s,o.length);d=(c=[t,n,l].join("")).length-l.length-4}else if(I(o,r)){let e=F(/```/,o,r)+3,t=o.substring(0,e),s=o.substring(e,o.length);d=(c=t+`
`+n+s).length-s.length-4}else{let e=o.substring(0,s),t=o.substring(s,o.length);d=(c=e+`
`+n+t).length-t.length-4}(0,w.m$)(t,c),t.focus(),t.setSelectionRange(d,d)}(t,n.closest(".js-suggested-changes-container").querySelector(".js-comment-field"))}),(0,o.on)("click",".js-refresh-after-suggestion",H.yQ),(0,a.lB)(".js-inline-comments-container",{add(e){z(e)}}),(0,a.lB)(".js-preview-body .js-apply-changes",{add(e){let t=e.closest(".js-suggested-changes-container");if(!t)return e.remove();let n=document.querySelector(".js-validation-on-right-blob").textContent,r=document.querySelector(".js-validation-on-left-blob").textContent,o=e.closest(".js-suggested-changes-blob");if(""!==t.getAttribute("data-thread-side")){if("left"===t.getAttribute("data-thread-side"))return U(r,o),e.remove()}else{let t=e.closest(".js-inline-comment-form"),n=t.querySelector('input[name="side"]');if(!t||!n)return e.remove();if(t&&"left"===n.value)return U(r,o),e.remove()}let s=e.previousElementSibling,l=s.querySelector(".js-blob-code-deletion"),i=s.querySelectorAll(".js-blob-code-addition");if(l&&0!==i.length){if(l.textContent===Array.from(i).map(e=>e.textContent).join(`
`))return U(n,o),e.remove();e.remove()}}}),(0,a.lB)(".js-comment-body .js-apply-changes",{add(e){let t,n=e.closest(".js-comment");if(!n)return e.remove();let r=n.querySelector(".js-suggested-changes-template");if(!(r instanceof HTMLTemplateElement))return e.remove();let o=r.content.cloneNode(!0),s=o.querySelector(".js-disabled-apply-suggestion-button");try{t=o.querySelector(".js-batched-suggested-changes-add")}catch(e){if("QueryError"!==e.name)throw e}if(document.querySelectorAll(".js-suggested-changes-files-tab").length){let e=document.querySelector(".js-add-to-batch-enabled").textContent;t&&(t.removeAttribute("disabled"),t.setAttribute("aria-label",e))}let l=o.querySelector(".js-open-in-editor"),i=document.querySelector(".js-pull-header-details"),a=i&&"true"===i.getAttribute("data-pull-is-open"),c=e.closest(".js-resolvable-timeline-thread-container"),d="true"===r.getAttribute("data-comment-pending"),u="true"===r.getAttribute("data-in-merge-queue");if(c&&"true"===c.getAttribute("data-resolved")){let n=document.querySelector(".js-resolved-thread").textContent,r=o.querySelector("details");return r&&r.remove(),N(s,n),W(t,l,n),e.replaceWith(o)}if(!a){let n=document.querySelector(B).textContent;return N(s,n),W(t,l,n),e.replaceWith(o)}if(u){let n=document.querySelector(".js-in-merge-queue"),r="";n&&(r=n.textContent||"");let i=o.querySelector("details");return i&&i.remove(),N(s,r),W(t,l,r),e.replaceWith(o)}if(d){let n=document.querySelector(".js-pending-review").textContent;return o.querySelector("details").remove(),N(s,n),W(t,l,n),e.replaceWith(o)}let m=document.querySelector(".js-suggested-changes-subset-files"),f="true"===r.getAttribute("data-outdated-comment");if(m||f){let n;return m?n=document.querySelector(R).textContent:f&&(n=document.querySelector(".js-outdated-comment").textContent),o.querySelector("details").remove(),N(s,n),W(t,l,n),e.replaceWith(o)}let g=o.querySelector(".js-single-suggested-change-form"),h=e.closest(".js-suggested-changes-blob");if(h){let e=h.querySelectorAll(".js-blob-code-deletion"),n=h.querySelectorAll(".js-blob-code-addition");if(!e)return;let r=Array.from(e).map(e=>e.textContent),i=Array.from(n).map(e=>e.textContent);if(r.length===i.length&&r.every((e,t)=>e===i[t])){let e=document.querySelector(".js-unchanged-suggestion").textContent;o.querySelector("details").remove(),N(s,e),W(t,l,e)}else for(let e of i){let t=document.createElement("input");t.setAttribute("type","hidden"),t.setAttribute("name","value[]"),t.value=e,g.appendChild(t)}}e.replaceWith(o)}}),(0,a.lB)(".js-pull-header-details",{add(e){let t="true"===e.getAttribute("data-pull-is-open"),n=document.querySelector(".js-suggested-changes-template");if(t||!(n instanceof HTMLTemplateElement))return;let r=n?.content,o=document.querySelector(B).textContent;$(r,o),P(o)}}),(0,a.lB)(".js-suggested-changes-subset-files",{add(){let e=document.querySelector(".js-suggested-changes-template");if(!(e instanceof HTMLTemplateElement))return;let t=e.content,n=document.querySelector(R).textContent;$(t,n),P(n)}}),(0,a.lB)(".js-suggested-changes-template",{add(e){let t="true"===e.getAttribute("data-head-oid-is-loaded");if(!(e instanceof HTMLTemplateElement)||t)return;let n=e.content,r=document.querySelector(".js-head-oid-not-loaded")?.textContent||"";$(n,r),P(r)}}),(0,o.on)("click",".js-apply-suggestion-button",async function(e){let t=e.currentTarget.parentElement;if(t){let e=t.querySelector(".js-suggestion-commit-title");setTimeout(()=>e.focus(),1)}}),(0,M.Ff)("keypress",".js-comment-field",function(e){"Enter"===e.key&&function(e){let t=e.selectionStart;if(!I(e.value,t))return!1;let n=e.value,r=k(n,t);if(null===r)return!1;let o=_(r),s=`
${o}`,l=n.substr(0,t)+s+n.substr(t);(0,w.m$)(e,l);let i=t+s.length;return e.setSelectionRange(i,i),!0}(e.target)&&e.preventDefault()}),(0,M.Ff)("keypress",".js-suggestion-commit-message",function(e){let t=e.currentTarget;"Enter"===e.key&&t.setAttribute("rows","3")}),(0,o.on)("click",".js-batched-suggested-changes-add",function(e){let t=e.target,n=t.closest(".js-suggested-change-form-container");if("true"!==n.getAttribute("data-comment-pending")&&"true"!==n.getAttribute("data-outdated-comment")&&"true"!==t.getAttribute("data-batched-suggestion-disabled-by-sibling")){for(let e of(n.setAttribute("data-pending-batched-suggestion","true"),t.closest(".js-inline-comments-container").querySelectorAll(".js-batched-suggested-changes-add")))e.setAttribute("data-batched-suggestion-disabled-by-sibling","true");t.removeAttribute("data-batched-suggestion-disabled-by-sibling"),O()}}),(0,o.on)("click",".js-batched-suggested-changes-remove",function(e){for(let t of(e.currentTarget.closest(".js-suggested-change-form-container").removeAttribute("data-pending-batched-suggestion"),e.currentTarget.closest(".js-inline-comments-container").querySelectorAll(".js-batched-suggested-changes-add")))t.setAttribute("data-batched-suggestion-reenable-sibling","true");O()}),(0,o.on)("click",".js-focus-commit-suggestions-form-button",function(e){e.preventDefault(),window.location.href="#clear-commit-suggestions",window.location.href="#commit-suggestions"}),(0,o.on)("click",".js-dismiss-batched-suggested-changes-onboarding-notice",async function(e){let t=e.currentTarget.getAttribute("data-url"),n=e.currentTarget.parentElement.querySelector(".js-data-url-csrf"),r=new FormData;if(r.append("notice","batched_suggested_changes_onboarding_prompt"),(await fetch(t,{method:"POST",mode:"same-origin",body:r,headers:{"Scoped-CSRF-Token":n.value,...(0,D.kt)()}})).ok)for(let e of document.querySelectorAll(".js-batched-suggested-change-onboarding-notice"))e.remove()}),(0,o.on)("click",".js-single-suggested-change-form .js-suggested-changes-submit",function(e){let t=e.currentTarget.closest(".js-single-suggested-change-form"),n=Array.from(t.querySelectorAll('input[name="value[]"]')).map(e=>e.value),r=[{commentId:t.querySelector("input[name=comment_id]").value,path:t.querySelector("input[name=path]").value,suggestion:n}];V(t,r)}),(0,E.JW)(".js-single-suggested-change-form",async function(e,t){let n=e.closest(".js-suggested-change-form-container"),r=e.closest("details"),o=n.querySelector(".js-suggestion-applied"),s=e.closest(".js-suggested-changes-contents").querySelector(".js-error-message-placeholder");try{await t.json(),o.classList.remove("d-none"),n.querySelector(".js-batched-suggested-changes-add").classList.add("d-none"),r.remove(),(0,H.yQ)()}catch(t){if("QueryError"!==t.name){let o=t.response.json&&t.response.json.error,l=s.querySelector(".js-error-message");s.hidden=!1,l.textContent=o,n.prepend(s),e.closest(".js-suggested-change-form-container").querySelector(".js-batched-suggested-changes-add").classList.add("d-none"),r.remove()}}}),(0,o.on)("click",".js-suggestion-batch-submit",function(e){let t=e.currentTarget.closest(".js-batched-suggested-changes-form"),n=[];for(let e of document.querySelectorAll("[data-pending-batched-suggestion]")){let t=e.querySelector(".js-single-suggested-change-form"),r=Array.from(t.querySelectorAll('input[name="value[]"]')).map(e=>e.value);n.push({commentId:t.querySelector("input[name=comment_id]").value,path:t.querySelector("input[name=path]").value,suggestion:r})}V(t,n)}),(0,E.JW)(".js-batched-suggested-changes-form",async function(e,t){try{await t.json(),e.closest(".js-batched-suggested-changes-container").hidden=!0,(0,H.yQ)()}catch(r){let t=r.response.json&&r.response.json.error,n=e.closest(".js-batched-suggested-changes-container").querySelector(".js-error-message-container");n.querySelector(".js-error-message").textContent=t,n.hidden=!1}}),(0,a.lB)(".js-files-tab-stale",{add(){let e=document.querySelector(".js-batched-suggested-changes-container");e&&setTimeout(()=>{e.hidden=!0})}});let J=0;function Q(e,t){let n=e.nextElementSibling;return n&&n.matches(t)?n:null}function K(e,t){let n=Array.from(e.querySelectorAll(".review-comment-form-container")).pop();if(n)return n.closest("div.js-line-comments");{let n=en("js-inline-comments-single-container-template",t).querySelector("div.js-line-comments");return e.appendChild(n),n}}function G(e){let t=e.querySelector(".js-toggle-file-notes");t instanceof HTMLInputElement&&(0,w.m$)(t,!0)}function X(){for(let e of document.querySelectorAll(".file .js-inline-comments-container")){let t=e.querySelectorAll(".js-comments-holder > *").length>0,n=null!=e.querySelector("[data-resolved='true']"),r=e.querySelector(".js-inline-comment-form-container"),o=!!r&&r.classList.contains("open");t||n||o||e.remove()}}async function Y(e){let t,n=e.querySelector(".js-suggestion-button-placeholder");if(!n)return;let r=n.getAttribute("data-src-base");if(!r)return;let o=new URL(r,window.location.origin),s=n.closest(".js-inline-comment-form")||n.closest(".js-comment-update");if(!(s instanceof HTMLFormElement))return;let l=function(e,t){let n=new URLSearchParams(e.search.slice(1)),r=t.elements.namedItem("in_reply_to")||t.elements.namedItem("comment_id"),o=t.querySelector("textarea");if(n.append("textarea_id",o.id),r instanceof HTMLInputElement&&r.value)return n.append("comment_id",r.value),n;let s=t.elements.namedItem("path"),l=t.elements.namedItem("start_side"),i=t.elements.namedItem("start_line"),a=t.elements.namedItem("side"),c=t.elements.namedItem("line"),d=t.elements.namedItem("start_commit_oid"),u=t.elements.namedItem("end_commit_oid"),m=t.elements.namedItem("base_commit_oid"),f=t.elements.namedItem("subject_type");return s instanceof HTMLInputElement&&l instanceof HTMLInputElement&&i instanceof HTMLInputElement&&a instanceof HTMLInputElement&&c instanceof HTMLInputElement&&d instanceof HTMLInputElement&&u instanceof HTMLInputElement&&m instanceof HTMLInputElement&&f instanceof HTMLInputElement?(n.append("path",s.value),n.append("start_side",l.value),n.append("start_line",i.value),n.append("end_side",a.value),n.append("end_line",c.value),n.append("start_commit_oid",d.value),n.append("end_commit_oid",u.value),n.append("base_commit_oid",m.value),n.append("subject_type",f.value),n):null}(o,s);if(l){o.search=l.toString();try{t=await (0,A.Ts)(document,o.toString())}catch{return}n.textContent="",n.appendChild(t)}}function Z(e,t,n,r){if(e.classList.remove("color-bg-success","color-bg-danger"),r){e.textContent=t;return}if("right"===n){e.classList.add("color-fg-success"),e.textContent=`+${t}`;return}if("left"===n){e.classList.add("color-fg-danger"),e.textContent=`-${t}`;return}e.textContent=String(t)}(0,o.on)("click",".js-add-file-comment",function(e){var t;let n,r,o,s=e.currentTarget;G(s.closest(".file"));let l=K(((function(e){let t=Q(e.closest(".file-header"),".diff-table");if(t instanceof Element){let e=t.querySelector(".js-inline-comments-container");if(e instanceof Element)return e}})(s)||(n=(t=s).closest(".file-header"),(r=document.createElement("table")).className="diff-table",o=en("js-inline-comments-single-container-template",t).firstElementChild,r.appendChild(o),n.after(r),o)).querySelector("td"),s),i=l.querySelector(".js-inline-comment-form");if(i instanceof HTMLFormElement){let e=i.getElementsByClassName("js-suggestion-button-placeholder")[0];e&&(e.style.display="none"),et(i,s)}(0,v.H)(l)}),(0,o.on)("click",".js-add-single-line-comment",function(e){var t;let n,r,o=e.currentTarget;G(o.closest(".file"));let s=K(((function(e){let t=Q(e.closest("tr"),".js-inline-comments-container");if(t instanceof Element)return t})(o)||(n=(t=o).closest("tr"),r=en("js-inline-comments-single-container-template",t).firstElementChild,n.after(r),r)).querySelector("td"),o),l=s.querySelector(".js-inline-comment-form");l instanceof HTMLFormElement&&et(l,o),(0,v.H)(s)}),(0,o.on)("click",".js-add-split-line-comment",function(e){let t=e.currentTarget;G(t.closest(".file"));let n=t.closest("tr"),r="addition"===t.getAttribute("data-type")?"js-addition":"js-deletion",o=K(function(e,t,n){let r=e.querySelector(`.js-line-comments.${t}`);if(r)return r;let o=en("js-inline-comments-split-form-container-template",n).firstElementChild;o.classList.add(t);let s=e.querySelectorAll(`.${t}`);for(let e of(s[s.length-1].after(o),s))e.remove();return o}(function(e){let t=Q(e,".js-inline-comments-container");if(t)return t;{let n="js-inline-comments-split-container-template",r=document.getElementById(n);if(!r)throw Error(`Could not find element with id ${n}`);if(!(r instanceof HTMLTemplateElement))throw Error(`Found element with id ${n} - but was not a Template`);return t=new q.i4(r,{}).firstElementChild,e.after(t),t}}(n),r,t),t),s=o.querySelector(".js-inline-comment-form");s instanceof HTMLFormElement&&et(s,t),(0,v.H)(o)}),(0,E.JW)(".js-inline-comment-form",async function(e,t){let n,r;(r=e.querySelector(".js-comment-form-error"))&&(r.hidden=!0,r.textContent=null);try{n=await t.json()}catch(t){if(t.response){let n;try{n=t.response.json}catch{}if(n){var o,s;let t;return void(o=e,s=n,(t=o.querySelector(".js-comment-form-error")).textContent=s.errors?Array.isArray(s.errors)?s.errors.join(", "):s.errors:"There was an error posting your comment.",t.style.display="block",t.hidden=!1,t.classList.remove("d-none"))}}throw t}let l=n.json,i=l.inline_comment,a=e.closest(".js-line-comments");i&&a.querySelector(".js-comments-holder").append((0,L.B)(document,i));let c=l.inline_comment_thread;if(c){let t=(0,L.B)(document,c),n=!1;if(l.replace_container){let r=e.closest(".js-inline-comments-container"),o=t.querySelector(".js-inline-comments-container");r&&o&&(r.replaceWith(o),n=!0)}n||(a.replaceWith(t),n=!0)}(0,v.i)(e)}),document.addEventListener("session:resume",function(e){let t=e.detail;!function(e){let[t,n]=e.match(/^new_inline_comment_(?:discussion|diff)_(?:[\w-]+)_(\d+)_(\d+)$/)||[];if(!t)return;let r=document.querySelector(`.js-inline-comment-form input[name='in_reply_to'][value='${n}']`);if(!r)return;let o=r.closest(".js-line-comments");o&&(0,v.H)(o)}(t.targetId),function(e){let[t,n]=e.match(/^new_inline_comment_diff_(?:[\w-]+)_(\d+)$/)||[];if(!t)return;let r=document.querySelector(`.js-add-line-comment[data-anchor='${t}'][data-position='${n}']`);r&&r.click()}(t.targetId)}),(0,a.lB)(".js-comment",{remove:X}),(0,o.on)("inlinecomment:focus",".js-inline-comment-form-container",function(e){let t=e.target.querySelector(".js-suggested-changes-container");t&&Y(t)}),(0,a.lB)(".js-suggested-changes-container.is-comment-editing",e=>{Y(e)}),document.addEventListener("inlinecomment:collapse",()=>{X()});let ee={R:"right",L:"left"};function et(e,t){for(let n of["type","path","position","line","side","original-line"]){let r=e.elements.namedItem(n);r instanceof HTMLInputElement&&(r.value=t.getAttribute(`data-${n}`)||"")}let n=e.elements.namedItem("subject_type");n instanceof HTMLInputElement&&(n.value=t.getAttribute("data-subject-type")||"");let r=e.getElementsByClassName("js-expanded-diff-placeholder-value")?.[0];r instanceof HTMLInputElement&&(r.value=t.getAttribute("data-expanded-diff")||""),function(e,t){let n=(0,S.lI)();if(!n||n.end.is(n.start))return;if(!(0,S.LU)(t,n))return(0,S.wr)();let{start:{lineNumber:r},end:{lineNumber:o}}=n,{start:{side:s},end:{side:l}}=n,i=Number(t.getAttribute("data-line")),a=t.getAttribute("data-side");if(i!==o||!n.end.isContext()&&a!==ee[l])return(0,S.wr)();let c=ee[s],d=e.elements.namedItem("start_line"),u=e.elements.namedItem("start_side"),m=e.elements.namedItem("line"),f=e.elements.namedItem("side"),g=e.elements.namedItem("preview_start_side"),h=e.elements.namedItem("preview_side");if(d instanceof HTMLInputElement&&u instanceof HTMLInputElement&&m instanceof HTMLInputElement&&f instanceof HTMLInputElement&&g instanceof HTMLInputElement&&h instanceof HTMLInputElement){d.value=String(r),u.value=c,u.value=g.value=u.value,h.value=f.value;let t=d.value;s=u.value;let o=m.value;l=f.value;let i=e.closest(".js-inline-comment-form-container");if(t&&o){let e=i.querySelector(".js-multi-line-preview"),r=e.querySelector(".js-multi-line-preview-start"),a=e.querySelector(".js-multi-line-preview-end"),c=n.start.isContext(),d=n.end.isContext();Z(r,t,s,c),Z(a,o,l,d),e.hidden=!1,i.classList.add("is-multiline")}else i.querySelector(".js-multi-line-preview").hidden=!0,i.classList.remove("is-multiline");z(i)}}(e,t)}function en(e,t){let n=document.getElementById(e);if(!n)throw Error(`Could not find element with id ${e}`);if(!(n instanceof HTMLTemplateElement))throw Error(`Found element with id ${e} - but was not a Template`);return new q.i4(n,{anchor:t.getAttribute("data-anchor")||"",position:t.getAttribute("data-position")||"",subject_type:t.getAttribute("data-subject-type")||"",sequence:J++})}var er=n(81151),eo=n(36186),es=n(17761),el=n(4559);function ei(e){var t,n;let r,o=ea();if(!o)return;ec(e,o);let l=(r=function(e,t){let n=/^(diff-[0-9a-f]{32})(?:[L|R]\d+)?$/.exec(t);if(!n)return;let r=n[1],o=e.querySelector(`a[name='${r}']`);if(!o)return;let s=o.nextElementSibling;if(!s||s.querySelector(".js-diff-load-container"))return s}(t=e,n=o))||function(e,t){let n=/^(?:r|commitcomment-)(\d+)$/.exec(t);if(!n)return;let r=n[1],o=e.querySelector(`#diff-with-comment-${r}`);if(o)return o.closest(".js-file")}(t,n);l&&((0,s.Rt)(l),ed(l))}function ea(){return window.location.hash.slice(1)}function ec(e,t){let n;if((n=t.match(/^diff-.+[LR]\d+-[LR]\d+/)?(0,eo.w$)(e.ownerDocument,t.substring(0,t.indexOf("-",5))):(0,eo.w$)(e.ownerDocument,t))&&e.contains(n))(0,er.Sz)(n),(0,s.Rt)(n);else for(let n of e.querySelectorAll(".js-comment-container")){let e=n.getAttribute("data-hidden-comment-ids");if(e){let r=e.split(","),o=t.match(/\d+/g)?.[0];if(o&&r.includes(o)){(0,es.d)(n);break}}}}function ed(e){let t=e.querySelector(".js-diff-entry-loader"),n=e.querySelector(".js-diff-placeholder"),r=e.querySelector("button.js-diff-load"),o=e.querySelector(".js-button-text");n.setAttribute("fill","url('#animated-diff-gradient')"),o.textContent=r.getAttribute("data-disable-with")||"",r.disabled=!0;let s=new URL(t.getAttribute("data-fragment-url")||"",window.location.origin);return t.src=s.toString(),t.data}(0,a.lB)(".js-diff-progressive-container",function(e){ei(e);let t=e.querySelector(".js-diff-progressive-loader");t&&t.addEventListener("load",function(){ei(e)})}),(0,a.lB)(".js-diff-load-container",function(e){let t=e.querySelector(".js-diff-entry-loader");t&&t.addEventListener("load",function(){let t=e.closest(".js-file");t.classList.remove("hide-file-notes-toggle");let n=t.getAttribute("data-tagsearch-path");(0,el.i)(`loaded diff for ${n}`);let r=ea();r&&ec(e,r)})}),(0,o.on)("click",".js-diff-load",function(e){if(e.target.classList.contains("js-ignore-this"))return;let t=e.currentTarget.closest(".js-diff-load-container");ed(t),t?.focus(),(0,el.i)("Loading...")});var eu=n(53627);(0,o.on)("click",".js-rendered, .js-source",function(e){var t;let n,r,o,s,l,i,a,c=e.currentTarget;c.classList.contains("selected")?e.preventDefault():(n=(t=c).closest(".js-file-header"),r=t.classList.contains("js-rendered"),o=t.classList.contains("js-source"),s=n.getAttribute("data-short-path"),l=n.getAttribute("data-anchor"),a=new URLSearchParams((i=new URL(window.location.href,window.location.origin)).search.slice(1)),i.hash=l,r?a.set("short_path",s):o&&a.delete("short_path"),i.search=a.toString(),(0,eu.bj)(i.toString()),function(e){for(let e of document.querySelectorAll(".js-rendered, .js-source"))e.classList.remove("selected"),e.removeAttribute("aria-current");e.classList.add("selected"),e.setAttribute("aria-current","true")}(c))}),(0,E.JW)(".js-prose-diff-toggle-form",async function(e,t){let n=e.closest(".js-details-container"),r=n.querySelector(".js-file-content"),o=n.querySelector(".js-file-header"),s=await t.html();for(;r.lastChild;)r.removeChild(r.lastChild);r.append(s.html),n.classList.toggle("display-rich-diff");let l=o?.querySelector('button.js-source[aria-current="true"], button.js-rendered[aria-current="true"]');requestAnimationFrame(()=>{l?.focus()})}),(0,o.on)("click",".js-toc-retry",function(e){if(!(e.target instanceof Element))return;let t=e.target.closest(".select-menu").querySelector("include-fragment"),n=t.getAttribute("src");t.setAttribute("src",""),t.setAttribute("src",n)}),(0,o.on)("click",".js-code-scanning-apply-autofix-form .js-code-scanning-apply-autofix-submit",function(e){let t=e.currentTarget.closest(".js-code-scanning-apply-autofix-form"),n=t.querySelector("input[name=commit_title]"),r=t.querySelector("textarea[name=commit_message]"),o=n.value.trim();""===o&&(o=n.defaultValue);let s=r.value.trim();""!==s&&(o=`${o}

${s}
`),n.disabled=!0,r.disabled=!0;let l=document.createElement("input");l.setAttribute("type","hidden"),l.setAttribute("name","message"),l.value=o,t.appendChild(l)}),(0,E.JW)(".js-code-scanning-apply-autofix-form",async function(e,t){let n=e.closest("details"),r=e.closest(".js-code-scanning-apply-autofix-container").querySelector(".js-error-message-placeholder");try{await t.json(),n.remove(),(0,H.yQ)()}catch(e){if("QueryError"!==e.name){let t=e.response.json&&e.response.json.error,o=r.querySelector(".js-error-message");r.hidden=!1,o.textContent=t,n.remove()}}});var em=n(54563);function ef(e,t,n){let r=Array.from(e.querySelectorAll('[role="menuitem"]')),o=r.indexOf(t),s=r.indexOf(n);if(-1===o)throw Error("Couldn't find startIndex in container");if(-1===s)throw Error("Couldn't find endItem in container");for(let t of(eh(e),r[s].classList.add("is-last-in-range"),o>s&&([o,s]=[s,o]),r.slice(o,s+1)))t.classList.add("is-range-selected")}async function eg(e,t){function n(n){ef(e,t,n.target.closest('[role="menuitem"]'))}ef(e,t,t),e.addEventListener("mouseover",n),await new Promise(e=>window.addEventListener("keyup",e,{once:!0})),e.removeEventListener("mouseover",n),eh(e)}function eh(e){for(let t of e.querySelectorAll('[role="menuitem"]'))t.classList.remove("is-range-selected","is-last-in-range")}(0,a.lB)(".js-diffbar-range-menu .js-diffbar-range-list",{subscribe:function(e){let t=e.closest("details-menu"),n=!1;function r(e){(n=e.shiftKey)&&e.preventDefault()}function o(t){if(!n)return;t.preventDefault();let r=t.detail.relatedTarget;if(r.classList.contains("is-range-selected")){t.stopPropagation();let n=e.querySelectorAll(".is-range-selected"),r=n[0],o=n[n.length-1],s=e.getAttribute("data-range-url"),l=r.getAttribute("data-parent-commit"),i=o.getAttribute("data-commit"),a=l&&i?`${l}..${i}`:i,c=s.replace("$range",a);(0,em.softNavigate)(c)}else t.stopImmediatePropagation(),eg(e,r)}return e.addEventListener("click",r,{capture:!0}),t.addEventListener("details-menu-select",o),{unsubscribe:()=>{e.removeEventListener("click",r,{capture:!0}),t.removeEventListener("details-menu-select",o)}}}}),(0,o.on)("toggle",".js-diffbar-range-menu",function(e){let t=e.currentTarget;if(!t.hasAttribute("open"))return;let n=t.querySelector(".in-range");n&&n.focus()},{capture:!0});var ep=n(82247);(0,o.on)("click",".js-compare-tab",function(e){for(let e of document.querySelectorAll(".js-compare-tab.selected"))e.classList.remove("selected");for(let t of(e.currentTarget.classList.add("selected"),document.querySelectorAll("#commits_bucket, #files_bucket, #commit_comments_bucket")))t.classList.add("d-none");let t=e.currentTarget.hash;document.querySelector(t).classList.remove("d-none"),e.preventDefault()}),(0,i.A)(function({target:e}){if(!(e instanceof HTMLElement))return;let t=e.closest("#commits_bucket, #files_bucket, #commit_comments_bucket");t&&t instanceof HTMLElement&&!(0,ep.A)(t)&&document.querySelector(`.js-compare-tab[href="#${t.id}"]`).click()}),(0,o.on)("click",".js-toggle-range-editor-cross-repo",function(){document.querySelector(".js-range-editor").classList.toggle("is-cross-repo")}),(0,a.lB)(".js-compare-pr.open",{add(){document.body.classList.add("is-pr-composer-expanded")},remove(){document.body.classList.remove("is-pr-composer-expanded")}}),(0,o.on)("change",".js-collab-checkbox",function({currentTarget:e}){for(let t of e.form.querySelectorAll(".errored"))t.classList.remove("errored");let t=e.closest(".js-collab-option").querySelector(".js-status-indicator");t.classList.remove("status-indicator-success","status-indicator-failed"),t.classList.add("status-indicator-loading")}),(0,E.JW)(".js-collab-form",async function(e,t){try{await t.text()}catch{for(let t of e.querySelectorAll(".status-indicator-loading")){t.classList.remove("status-indicator-loading"),t.classList.add("status-indicator-failed");let e=t.closest(".js-collab-option");e.classList.add("errored");let n=e.querySelector(".js-collab-checkbox");n.checked=!n.checked}for(let t of e.querySelectorAll(".status-indicator-success"))t.classList.remove("status-indicator-success");return}for(let t of e.querySelectorAll(".errored"))t.classList.remove("errored");for(let t of e.querySelectorAll(".status-indicator-loading"))t.classList.remove("status-indicator-loading"),t.classList.add("status-indicator-success")}),(0,o.on)("click",".js-dependabot-apply-autofix-form .js-dependabot-apply-autofix-submit",function(e){let t=e.currentTarget.closest(".js-dependabot-apply-autofix-form"),n=t.querySelector("input[name=commit_title]"),r=t.querySelector("textarea[name=commit_message]"),o=n.value.trim();""===o&&(o=n.defaultValue);let s=r.value.trim();""!==s&&(o=`${o}

${s}
`),n.disabled=!0,r.disabled=!0;let l=document.createElement("input");l.setAttribute("type","hidden"),l.setAttribute("name","message"),l.value=o,t.appendChild(l)}),(0,E.JW)(".js-dependabot-apply-autofix-form",async function(e,t){let n=e.closest("details"),r=e.closest(".js-dependabot-apply-autofix-container").querySelector(".js-error-message-placeholder");try{await t.json(),n.remove(),(0,H.yQ)()}catch(e){if("QueryError"!==e.name){let t=e.response.json&&e.response.json.error,o=r.querySelector(".js-error-message");r.hidden=!1,o.textContent=t,n.remove()}}});var eb=n(35750),ey=n(18150),ej=n(85242),ev=n(50467),eS=n(31635),eq=n(39595),ew=n(45062),eA=new WeakMap,eL=new WeakMap,eE=new WeakMap,eC=new WeakMap;let DiffLayoutElement=class DiffLayoutElement extends HTMLElement{connectedCallback(){if(!this.sidebarContainer)return;(0,ej._)(this,eC,new MutationObserver(this.handleNotificationShelfMutation)),(0,eb._)(this,eC).observe(document.body,{subtree:!0,childList:!0});let{signal:e}=(0,ej._)(this,eE,new AbortController);window.addEventListener("scroll",this.handleSidebarScroll,{signal:e}),window.addEventListener("resize",()=>this.handleSidebarResize(),{signal:e}),this.handleSidebarScroll()}disconnectedCallback(){this.sidebarContainer&&((0,eb._)(this,eC).disconnect(),(0,eb._)(this,eE)?.abort(),null!=(0,eb._)(this,eA)&&cancelAnimationFrame((0,eb._)(this,eA)),null!=(0,eb._)(this,eL)&&cancelAnimationFrame((0,eb._)(this,eL)))}toggleSidebar(e){if(this.layoutContainer.classList.toggle("hx_Layout--sidebar-hidden"),this.sidebarHidden=!this.sidebarHidden,!this.fileTree)return;let t=e.detail.toggleButton;!t||(this.fileTree.instrumentToggleFileTree(t),this.fileTreePathFilter&&"show-file-tree-button"===t.id&&this.fileTreePathFilter.focus())}handleOpenFilesListHotkeyEvent(){this.shouldOpenTocMenu()?this.tocMenuButton.click():this.fileTree&&(this.showFileTreeButton&&this.sidebarHidden?this.showFileTreeButton.click():this.fileTreePathFilter&&!this.sidebarHidden&&this.fileTreePathFilter.focus())}shouldOpenTocMenu(){return!!(this.tocMenu&&!this.tocMenu.hasAttribute("open")&&"none"!==window.getComputedStyle(this.tocMenu).display)}handleNotificationShelfMutation(e){let t=document.firstElementChild;if(t.classList.contains("js-skip-scroll-target-into-view"))for(let n of e){for(let e of n.addedNodes)if(e instanceof HTMLElement&&e.classList.contains("js-notification-top-shelf")){t.classList.add("has-notification-top-shelf");break}for(let e of n.removedNodes)if(e instanceof HTMLElement&&e.classList.contains("js-notification-top-shelf")){t.classList.remove("has-notification-top-shelf");break}}}handleSidebarResize(){(0,ej._)(this,eL,requestAnimationFrame(this.updateSidebarHeight))}constructor(...e){super(...e),(0,ev._)(this,"sidebarHidden",!1),(0,ey._)(this,eA,{writable:!0,value:null}),(0,ey._)(this,eL,{writable:!0,value:null}),(0,ey._)(this,eE,{writable:!0,value:void 0}),(0,ey._)(this,eC,{writable:!0,value:void 0}),(0,ev._)(this,"handleSidebarScroll",()=>{(0,ej._)(this,eA,requestAnimationFrame(this.updateSidebarHeight))}),(0,ev._)(this,"updateSidebarHeight",()=>{let e;if(!this.sidebarContainer||!this.diffToolbar)return;let t=document.documentElement.clientHeight,n=this.diffToolbar.getBoundingClientRect(),r=this.mainContainer.getBoundingClientRect(),o=t>=r.bottom,s=0===n.top;o?(e=r.bottom-parseInt(this.sidebarContainer.style.top),e=Math.min(r.height,e)):e=s?t-n.height:t-this.sidebarContainer.getBoundingClientRect().top,this.sidebarContainer.style.height=`${e}px`})}};(0,ev._)(DiffLayoutElement,"attrPrefix",""),(0,eS.Cg)([eq.CF],DiffLayoutElement.prototype,"sidebarHidden",void 0),(0,eS.Cg)([eq.aC],DiffLayoutElement.prototype,"layoutContainer",void 0),(0,eS.Cg)([eq.aC],DiffLayoutElement.prototype,"diffToolbar",void 0),(0,eS.Cg)([eq.aC],DiffLayoutElement.prototype,"tocMenu",void 0),(0,eS.Cg)([eq.aC],DiffLayoutElement.prototype,"tocMenuButton",void 0),(0,eS.Cg)([eq.aC],DiffLayoutElement.prototype,"mainContainer",void 0),(0,eS.Cg)([eq.aC],DiffLayoutElement.prototype,"sidebarContainer",void 0),(0,eS.Cg)([eq.aC],DiffLayoutElement.prototype,"fileTree",void 0),(0,eS.Cg)([eq.aC],DiffLayoutElement.prototype,"showFileTreeButton",void 0),(0,eS.Cg)([eq.aC],DiffLayoutElement.prototype,"fileTreePathFilter",void 0),(0,eS.Cg)([(0,ew.s)(100)],DiffLayoutElement.prototype,"handleSidebarResize",null),DiffLayoutElement=(0,eS.Cg)([eq.p_],DiffLayoutElement),(0,o.on)("click",".js-split-diff-view",function(){let e=document.querySelector(".js-unified-diff-view-box"),t=document.querySelector(".js-split-diff-view-box"),n=document.querySelector(".js-split-diff-view-option"),r=document.querySelector(".js-unified-diff-view-option");t.classList.add("color-border-accent-emphasis"),t.classList.remove("color-border-default"),e.classList.remove("color-border-accent-emphasis"),e.classList.add("color-border-default"),r.checked=!1,n.checked=!0}),(0,o.on)("click",".js-unified-diff-view",function(){let e=document.querySelector(".js-unified-diff-view-box"),t=document.querySelector(".js-split-diff-view-box"),n=document.querySelector(".js-split-diff-view-option"),r=document.querySelector(".js-unified-diff-view-option");t.classList.remove("color-border-accent-emphasis"),t.classList.add("color-border-default"),e.classList.add("color-border-accent-emphasis"),e.classList.remove("color-border-default"),r.checked=!0,n.checked=!1});var eT=n(87465),ex=n(52738);let ek=class InstrumentFilesElement extends HTMLElement{connectedCallback(){document.addEventListener("keydown",this.instrumentCtrlF)}disconnectedCallback(){document.removeEventListener("keydown",this.instrumentCtrlF)}constructor(...e){super(...e),(0,ev._)(this,"instrumentCtrlF",e=>{["Control+f","Meta+f"].includes((0,eT.Vy)(e))&&(0,ex.HV)(this)})}};ek=(0,eS.Cg)([eq.p_],ek);var e_=n(94147),eF=n(88578);(0,o.on)("details:toggled",".js-pull-merging",function({currentTarget:e}){let t=Array.from(e.querySelectorAll(".js-merge-pull-request")),n=t.some(ep.A);for(let e of t)e.classList.toggle("is-dirty",n)}),(0,o.on)("click",".js-merge-box-try-again",async function({currentTarget:e}){let t=e.getAttribute("data-form-target");if(!["js-cleanup-branch-form","js-merge-branch-form","js-queue-branch-form","js-update-branch-form"].includes(t))return;let n=e.closest(".js-pull-merging").getElementsByClassName(t)[0];(0,o.h)(n,"submit")}),document.addEventListener("session:resume",function(e){let t=document.getElementById(e.detail.targetId);if(t){let e=t.closest(".js-merge-pull-request");if(e){let t=e.closest(".js-details-container");t&&t.classList.add("open")}}}),(0,o.on)("change",".js-admin-merge-override",function({currentTarget:e}){let t=e.closest(".js-merge-message-container"),n=e.checked,r=t.querySelector(".js-merge-box"),o=t.querySelector(".js-auto-merge-box"),s=t.querySelector(".js-merge-form"),l=t.querySelector(".js-auto-merge-form"),i=t.querySelector(".js-queue-branch-form"),a=t.querySelectorAll(".merge-box-button");for(let e of(r&&(r.hidden=!n),o&&(o.hidden=n),s&&(s.hidden=!n),l&&(l.hidden=n),i&&(i.hidden=n),a))e.disabled=!n}),(0,o.on)("details-menu-selected",".js-update-branch-method-menu",function(e){let t=e.detail.relatedTarget,n=t.closest(".js-merge-pr");n.classList.toggle("is-updating-via-merge","merge"===t.value),n.classList.toggle("is-updating-via-rebase","rebase"===t.value);let r=n.querySelector(".js-update-branch-type");r&&(r.value=t.value)},{capture:!0}),(0,o.on)("submit",".js-update-branch-form",function({currentTarget:e}){let t=e.closest(".js-merge-pr"),n=t?.querySelector(".btn-group-update-merge");n&&(n.disabled=!0);let r=t?.querySelector(".btn-group-update-rebase");r&&(r.disabled=!0);let o=t?.querySelector(".js-update-method-menu-button");o&&(o.classList.add("disabled","user-select-none"),o.setAttribute("aria-disabled","true"));let s=t?.querySelector(".js-update-branch-method-menu");s&&s?.parentNode?.removeChild(s)}),(0,o.on)("details-menu-selected",".js-merge-method-menu",function(e){let t=e.detail.relatedTarget,n=t.closest(".js-merge-pr"),r=n.querySelector(".js-merge-pull-request"),o=n.querySelector(".js-merge-method-menu-button"),s=o.getAttribute("data-merge-button-class");o.classList.toggle("btn-danger",t.hasAttribute("data-dangerous-action")),s&&o.classList.toggle(s,!t.hasAttribute("data-dangerous-action"));let l=n.querySelectorAll(".js-merge-title"),i=n.querySelectorAll(".js-merge-message");for(let e of document.querySelectorAll(".js-merge-method-menu button"))e.setAttribute("aria-checked",e.value===t.value?"true":"false");for(let e of l)e.defaultValue===e.value&&(e.defaultValue=e.value=t.getAttribute("data-input-title-value"));for(let e of i)e.defaultValue===e.value&&(e.defaultValue=e.value=t.getAttribute("data-input-message-value"));n.classList.toggle("is-merging","merge"===t.value),n.classList.toggle("is-squashing","squash"===t.value),n.classList.toggle("is-rebasing","rebase"===t.value),n.classList.toggle("is-merging-group","group"===t.value),n.classList.toggle("is-merging-solo","solo"===t.value),n.classList.toggle("is-merging-jump","jump"===t.value);let a=r.classList.contains("js-admin-override-merge")&&"merge"===t.value||r.classList.contains("js-admin-override-squash")&&"squash"===t.value||r.classList.contains("js-admin-override-rebase")&&"rebase"===t.value,c=n.querySelector(".js-merge-type");for(let e of(c&&(c.value=t.value),n.querySelectorAll(".js-merge-pull-request .js-merge-commit-button,.js-confirm-auto-merge-button")))t.value===e.value?(e.type="submit",e.classList.contains("js-confirm-auto-merge-button")&&(0,eF.A)(e)):e.type="button";r.classList.toggle("color-fg-danger",a);let d=n.closest(".js-pull-merging"),u=new URL(d.getAttribute("data-url"),window.location.origin),m=new URLSearchParams(u.search);m.set("merge_type",t.value),u.search=m.toString(),d.setAttribute("data-url",u.toString())},{capture:!0}),(0,o.on)("details:toggled",".js-merge-pr",function(e){let t=e.currentTarget.querySelector(".js-merge-message");t&&(0,o.h)(t,"change")}),(0,a.lB)(".branch-action-item.js-details-container.open",{add(e){for(let t of e.querySelectorAll(".js-merge-review-section"))t.setAttribute("open","")},remove(e){for(let t of e.querySelectorAll(".js-merge-review-section"))t.removeAttribute("open")}}),(0,o.on)("toggle",".js-details-container .js-merge-review-section",function({currentTarget:e}){let t=e.closest(".js-details-container"),n=t.querySelectorAll(".js-merge-review-section").length,r=t.querySelectorAll(".js-merge-review-section[open]").length;0===r?(0,er.kn)(t,{force:!1}):r===n&&(0,er.kn)(t,{force:!0})},{capture:!0}),(0,a.lB)("poll-include-fragment[data-to-be-polled]",{constructor:e_.T,add(e){function t(){e.src=e.getAttribute("data-to-be-polled"),e.removeAttribute("data-to-be-polled")}document.hidden?document.addEventListener("visibilitychange",t,{once:!0}):t()}}),(0,o.on)("submit",".js-remove-from-queue-form",async e=>{let t=e.currentTarget;e.preventDefault();let n=await fetch(t.action,{method:t.method,body:new FormData(t),headers:{Accept:"application/json"}});n&&n.ok||(window.onbeforeunload=()=>{window.scrollTo({top:0})},window.location.reload())});var eI=n(95493);let eM=!1;function eH(){let e=document.querySelectorAll(".pull-request-ref-restore");for(let t=0;t<e.length;t++)e[t].classList.toggle("last",t===e.length-1)}function eD(){let e=null!=document.querySelector("#js-pull-restorable"),t=document.querySelector(".js-pull-discussion-timeline");t&&t.classList.toggle("is-pull-restorable",e)}document.addEventListener("keydown",function(e){"Alt"===e.key&&(eM=!0)}),document.addEventListener("keyup",function(e){"Alt"===e.key&&(eM=!1)}),(0,o.on)("click",".js-toggle-outdated-comments",function(e){if(!(e instanceof MouseEvent&&e.altKey||eM)||!(e.currentTarget instanceof HTMLElement))return;let t=e.currentTarget,n=t.closest("details");function r(){let e=n.hasAttribute("open");for(let n of document.querySelectorAll(".js-toggle-outdated-comments"))n!==t&&n.closest("details").toggleAttribute("open",e)}setTimeout(()=>{(0,eI._H)(t,r)})}),document.addEventListener("head-ref-deleted",()=>{let e=document.querySelectorAll(".pull-request-ref-restore");if(e.length>0)for(let t of e)t.classList.remove("last")}),(0,a.lB)(".pull-request-ref-restore",{add:eH,remove:eH}),(0,a.lB)("#js-pull-restorable",{add:eD,remove:eD});var eB=n(47643);function eR(e){let t=document.querySelector(".js-reviews-container");t&&setTimeout(()=>(function(e,t){let n=e.closest(".js-review-state-classes"),r=document.querySelector(".js-review-changes");for(let e of(n.classList.toggle("is-review-pending",t>0),document.querySelectorAll(".js-pending-review-comment-count")))e.textContent=String(t);for(let e of document.querySelectorAll(".js-pending-comment-count-type"))e instanceof HTMLElement&&(e.textContent=e.getAttribute(1===t?"data-singular-string":"data-plural-string"));if(t>0){r.textContent=r.getAttribute("data-pending-message")||"";let t=e.querySelector(".js-reviews-toggle");t?.classList.add("anim-pulse-in"),t?.addEventListener("animationend",()=>t.classList.remove("anim-pulse-in"),{once:!0})}else r.textContent=r.getAttribute("data-message")||""})(t,e))}(0,E.JW)(".js-inline-comment-form",async function(e,t){eR((await t.text()).json.pendingReviewCommentsCount)}),(0,E.JW)(".js-pending-review-comment .js-comment-delete",async function(e,t){eR((await t.text()).json.pendingReviewCommentsCount)}),(0,E.JW)(".js-resolvable-timeline-thread-form",async function(e,t){try{let n=await t.html();e.closest(".js-resolvable-timeline-thread-container").replaceWith(n.html)}catch{(0,eB.n)()}});var e$=n(82591),eP=n(3779);function eN(e,t){let n=document.querySelector("template.js-flash-template");n.after(new q.i4(n,{className:"flash-error",message:e})),t.removeAttribute("open")}function eW(e,t,n){let r=t.closest(".js-pull-merging");if(!r)return;r.classList.add("is-error"),r.getElementsByClassName("merge-branch-description")[0].textContent=e;let o=r.querySelector("input[name='expected_head_oid']");o&&(o.value=n)}function eU(e){return e.getAttribute("ratio").split("/")}function ez(e){if(e){let[t,n]=eU(e),r=parseInt(t)/parseInt(n),o=e.querySelector(".js-review-progress"),s=e.querySelector(".js-review-count");o instanceof HTMLElement&&s&&(o.style.width=`${100*r}%`,s.textContent=`${t} / ${n}`)}}document.addEventListener(e$.z.SUCCESS,function(){for(let e of document.querySelectorAll(".js-pull-refresh-on-pjax"))(0,H.le)(e)}),document.addEventListener("turbo:restored",function(){for(let e of document.querySelectorAll('[data-refresh-on-turbo-restored="true"]'))(0,H.le)(e)}),(0,o.on)("click",".js-change-base-form-button",async function(e){e.preventDefault();let t=e.currentTarget,n=t.querySelector(".js-change-base-spinner");t.disabled=!0,n.style.display="inline",await (0,eP.A)();let r=e.target.closest("details");try{let e=t.form,n=await fetch(e.action,{method:e.method,body:new FormData(e),headers:{...(0,D.kt)(),Accept:"application/json"}}),o=await n.json();if((0,er.kn)(document.querySelector(".js-pull-header-details"),{force:!1}),!n.ok)return void eN(o.error_message,r);let s=null;s=o.job?o.job.url:o.orchestration.url;let l=await (await (0,A.Ee)(s,{headers:{accept:"application/json"}})).json();if(l.orchestration)if(!l.orchestration.error_message)return(0,H.yQ)();else eN(l.orchestration.error_message,r);else{if(!l.job.error_message)return(0,H.yQ)();eN(l.job.error_message,r)}}catch{eN("An unknown error occured.",r)}}),(0,E.JW)(".js-update-branch-async-button",async function(e,t){await (0,eP.A)();try{let n=await t.json(),r=await (await (0,A.Ee)(n.json.orchestration.url,{headers:{accept:"application/json"}})).json();if(r.orchestration.error_message)eW(r.orchestration.error_message,e,r.orchestration.current_head_sha);else if(e.getElementsByClassName("js-update-branch-type")[0]?.getAttribute("value")==="rebase")return(0,H.yQ)()}catch{eW("An unknown error occured.",e,"")}}),(0,a.lB)(".js-updating-pull-request-commits-count",{add(e){let t=e.textContent;for(let e of document.querySelectorAll(".js-updateable-pull-request-commits-count"))e.textContent=t}}),(0,E.JW)(".js-toggle-user-reviewed-file-form",async function(e,t){let n=e.closest(".js-details-container"),r=!!n.querySelector(".js-reviewed-file"),o=n.querySelector(".js-file-level-comments-table"),l=n.classList.contains("open"),i=n.querySelector(".js-file-header"),a=!!i&&60===i.getBoundingClientRect().top;(!r&&l||r&&!l)&&((0,er.kn)(n),o&&o.classList.toggle("hidden"),a&&(0,s.Rt)(n));let c=e.querySelector(".js-reviewed-toggle");r?(c.classList.remove("color-bg-accent","color-border-accent"),c.classList.add("color-fg-muted","color-border-default")):(c.classList.remove("color-fg-muted","color-border-default"),c.classList.add("color-bg-accent","color-border-accent"));let d=c.querySelector(".js-reviewed-checkbox");d.disabled=!0;let u=document.querySelector("progress-bar");u instanceof eO&&(r?u.decrement():u.increment());let m=document.getElementById(`file-tree-item-${n.id}`);m&&m.toggleAttribute("data-file-user-viewed");try{let r=await t.html(),o=e.closest(".js-replace-file-header-review");o&&(o.replaceWith(r.html),n.toggleAttribute("data-file-user-viewed"))}catch{let e=document.querySelector("template.js-flash-template");e.after(new q.i4(e,{className:"flash-error",message:"There was an error marking the file as viewed."})),d.checked=!1,d.disabled=!1}});let eO=class ProgressBarElement extends HTMLElement{static get observedAttributes(){return["ratio"]}attributeChangedCallback(e){"ratio"===e&&ez(this)}connectedCallback(){ez(this)}increment(){let[e,t]=eU(this),n=Math.min(parseInt(e)+1,parseInt(t));this.setAttribute("ratio",`${n}/${t}`)}decrement(){let[e,t]=eU(this),n=Math.min(parseInt(e)-1,parseInt(t));n=Math.max(n,0),this.setAttribute("ratio",`${n}/${t}`)}};window.customElements.get("progress-bar")||(window.ProgressBarElement=eO,window.customElements.define("progress-bar",eO));var eV=n(89022),eJ=n(21890);function eQ(e){(0,er.Sz)(e),(0,s.Rt)(e)}async function eK(e,t){var n,r;let{anchor:o,side:s,line:l,lastLine:i,hashFragment:a,partialHashFragment:c}=e,d=(0,eo.w$)(document,o);if(!d)return;let u=eY(d,s,l,i);if(!u.length){let e=(0,eo.w$)(document,a);if(e)return void eQ(e);let t=d.querySelector(".js-diff-load-container");if(!t)return;try{let e,n,r,o,s;await (e=t.querySelector(".js-diff-entry-loader"),n=t.querySelector(".js-diff-placeholder"),r=t.querySelector("button.js-diff-load"),o=t.querySelector(".js-button-text"),n.setAttribute("fill","url('#animated-diff-gradient')"),o.textContent=r.getAttribute("data-disable-with")||"",r.disabled=!0,s=new URL(e.getAttribute("data-fragment-url")||"",window.location.origin),e.src=s.toString(),e.data);let l=(0,eo.w$)(document,a);l instanceof HTMLElement&&eQ(l)}catch{eQ(d)}return}await (n=u,r=c,Promise.all(n.map(e=>eG(e,r))));let m=(0,eo.w$)(document,a);eY(d,s,l,i).length?eK(e,t):m?eQ(m):t<1&&eK(e,t+1)}async function eG(e,t){var n;let r,s;if(t){let n="R"===t.slice(-1)?"data-right-range":"data-left-range";r=t+parseInt((e.getAttribute(n)||"").split("-")[0],10)}else r=e.hash.slice(1);let l=new URL(e.getAttribute("data-url"),window.location.origin),i=new URLSearchParams(l.search.slice(1));i.append("anchor",r),l.search=i.toString();let a=await (0,A.Ts)(document,l.toString()),c=e.closest(".js-file");if(!c)return;let d=e.closest(".js-expandable-line"),u=eX(d,".file-diff-line");u?(0,eI._H)(u,()=>{d.replaceWith(a)}):d.replaceWith(a),(0,o.h)(c,"expander:expanded"),(s=(n=c).querySelector(".js-expand-full-wrapper"))&&0===Array.from(n.querySelectorAll(".js-expand")).length&&s.parentElement.removeChild(s)}function eX(e,t){let n=e.nextElementSibling;return n instanceof HTMLElement&&n.matches(t)?n:null}function eY(e,t,n,r){let o=parseInt(n,10),s=parseInt(r||"",10);return Array.from(e.querySelectorAll(".js-expand")).filter(e=>{let n=(e.getAttribute("R"===t?"data-right-range":"data-left-range")||"").split("-"),r=parseInt(n[0],10),l=parseInt(n[1],10);return!!(r<=o)&&!!(o<=l)||!!(o<=r)&&!!(l<=s)||!!(r<=s)&&!!(s<=l)||!1})}async function eZ(e,t){let n=await self.fetch(t,{headers:{"Content-Type":"application/json",Accept:"application/json"}});if(!n.ok)throw Error(`Request to blob_expand failed with status code ${n.status}`);return(await n.json()).map(t=>({...t,content:(0,L.B)(e,t.content)}))}function e0(e,t){return!!(e instanceof HTMLElement&&(0,eJ.hq)(e))&&t(e)}(0,i.A)(function(){let e=function(e){if(!e)return;let t=(0,eV.E)(e);if(!t)return;let n=t[1],r=t[2],o=t[3];return{anchor:n,side:r,line:o,lastLine:t[5],hashFragment:n+r+o,partialHashFragment:n+r}}(window.location.hash);e&&(!(0,eo.w$)(document,e.hashFragment)||e.lastLine)&&eK(e,0)}),(0,o.on)("click",".js-expand",function(e){e.preventDefault(),eG(e.currentTarget)}),(0,o.on)("click",".js-expand-full",async e=>{e.preventDefault();let t=e.currentTarget,n=t.closest(".file"),r=t.getAttribute("data-url"),o=function(e){let t=Array.from(e.querySelectorAll(".js-expand")).map((e,t)=>{let n;return n=new URL(e.getAttribute("data-url"),window.location.origin).searchParams,{position:t.toString(),left:{start:n.get("last_left"),end:n.get("left"),size:n.get("left_hunk_size")},right:{start:n.get("last_right"),end:n.get("right"),size:n.get("right_hunk_size")}}}),n=!1,r=[];for(let e=0;e<t.length;e++){if(n){n=!1;continue}let o=t[e],s=t[e+1];n=!!s&&o.left.start===s.left.start&&o.left.end===s.left.end&&o.right.start===s.right.start&&o.right.end===s.right.end,r.push(o)}return r}(n);function s(){t.setAttribute("hidden","true");let e=n.querySelector(".js-collapse-diff");e&&e.removeAttribute("hidden"),n.classList.add("open"),n.classList.add("Details--on")}if(e0(n,eJ.Qs))return void s();if(0===o.length)return;let l=new URL(r,window.location.origin),i=new URLSearchParams(l.search.slice(1));for(let e of o)i.append("ranges[]last_left",e.left.start),i.append("ranges[]left",e.left.end),i.append("ranges[]left_hunk_size",e.left.size),i.append("ranges[]last_right",e.right.start),i.append("ranges[]right",e.right.end),i.append("ranges[]right_hunk_size",e.right.size),i.append("ranges[]position",e.position);l.search=i.toString();let a=await eZ(document,l.toString()),c=[...n.querySelectorAll(".js-expand")];for(let{content:e,position:t}of a){let n=c[parseInt(t,10)];if(!n)return;let r=n.closest(".js-expandable-line"),o=eX(r,".file-diff-line");o?(0,eI._H)(o,()=>{r.after(e)}):r.after(e),r.setAttribute("hidden","true")}s()}),(0,o.on)("click",".js-collapse-diff",e=>{let t=e.currentTarget,n=t.closest(".file");function r(){t.setAttribute("hidden","true");let e=n.querySelector(".js-expand-full");e&&e.removeAttribute("hidden")}if(e0(n,eJ.zr))return void r();for(let e of[...n.querySelectorAll('.blob-expanded[data-expanded-full="true"]')])e.parentElement.removeChild(e);for(let e of[...n.querySelectorAll(".js-expandable-line")])e.removeAttribute("hidden");r()});let DiffTableSideProtection=class DiffTableSideProtection{range(){let e;return this.selection?.rangeCount>0&&(e=this.selection.getRangeAt(0)),e}canBeSideProtected(){try{return!!(this.hasSelectedText()&&this.confinedTable())}catch{return!1}}isSideProtected(){try{return!!this.confinedTable()?.getAttribute("data-lock-side-selection")}catch{return!1}}hasSelectedText(){let e=this.range();return!!e&&e.toString().length>0}clearSelectedText(){this.selection.removeAllRanges()}confinedTable(){let e=this.range()?.commonAncestorContainer?.parentElement;return e?.matches(".diff-table")?e:e?.matches(".js-file-content")?e?.querySelector("table.diff-table"):e?.closest("table.diff-table")}unprotectedSide(){let e;return e=this.anchorNode instanceof HTMLTableCellElement?this.anchorNode.closest("td[data-split-side]"):this.anchorNode?.parentElement?.closest("td[data-split-side]"),e?.getAttribute("data-split-side")}protectedSide(){return"left"===this.unprotectedSide()?"right":"left"}applySideProtection(){if(this.unprotectedSide()){let e=this.confinedTable(),t=this.unprotectedSide();e&&t&&e.setAttribute("data-lock-side-selection",t)}}clearSideProtection(){for(let e of document.querySelectorAll("table[data-lock-side-selection]"))e.removeAttribute("data-lock-side-selection")}filteredTableRows(){let e=[];for(let t=0;t<this.selection.rangeCount;t++){let n=this.selection.getRangeAt(t).cloneContents();if(n.querySelectorAll("td").length){let t=`td[data-split-side=${this.protectedSide()}], td.js-linkable-line-number, td.empty-cell, .inline-comments`;for(let e of n.querySelectorAll(t))e.parentNode&&e.parentNode.removeChild(e);e.push(...n.children)}else{let t=document.createElement("TR"),r=document.createElement("TD");r.append(...n.childNodes),t.append(r),e.push(t)}}return e}contentToString(){let e=[],t=document.createElement("table");t.classList.add("invisible"),t.append(...this.filteredTableRows()),this.confinedTable()?.append(t);let n=t.children;for(let t=0;t<n.length;t++){let r=n[t].innerText;r&&(`
`===r?e.push(""):e.push(r))}return t.remove(),e.join(`
`)}constructor(e){(0,ev._)(this,"selection",void 0),(0,ev._)(this,"anchorNode",void 0),this.selection=e,this.anchorNode=e.anchorNode}};function e1(e){return Math.floor(e/2)}function e5(e,t){let n=e.parentElement;n&&(!function(e){let t=e.querySelector(".js-comment-button-placeholder");if(t?.parentElement){let n=document.querySelector(".js-comment-button-template");if(!n)throw Error("missing js-comment-button-template template element!");let r=t.dataset;if(!r)throw Error("placeholder element has no dataset");r.originalLine=e.querySelector(".blob-code-inner")?.textContent||"";let o=new q.i4(n,r);if(t.parentElement.replaceChild(o,t),r.expandedDiff){let t=e.querySelector(".js-add-line-comment");t&&t.setAttribute("data-expanded-diff",r.expandedDiff)}}}(n),function(e,t,n){let r,o=e.children;if(4===o.length)for(let e=0,n=o.length;e<n;e++)o[e]===t&&(r=e1(e));for(let e=0,t=o.length;e<t;e++){let t=o[e];(null==r||e1(e)===r)&&t.classList.toggle("is-hovered",n)}}(n,e,t))}function e7(e){let t=document.getSelection();if(t){let n=new DiffTableSideProtection(t);n.isSideProtected()&&(e.clipboardData?.setData("text/plain",n.contentToString()),e.preventDefault())}}function e3(e){let t=document.getSelection(),n=2===e.button;if(t&&!n){let e=new DiffTableSideProtection(t);e.isSideProtected()&&(e.clearSelectedText(),e.clearSideProtection())}}function e9(){let e=document.getSelection();if(e){let t=new DiffTableSideProtection(e);t.canBeSideProtected()?t.applySideProtection():t.clearSideProtection()}}function e2(){let e=document.querySelector("meta[name=diff-view]"),t=e&&e instanceof HTMLMetaElement?e.content:"",n=document.querySelector(".js-file-diff-split"),r=!!("split"===t&&n||document.querySelector(".wants-full-width-container"));document.body.classList.toggle("full-width",r)}function e4(e){let t=e.some(e=>e.checked);for(let n of e)(0,w.m$)(n,!t)}(0,a.lB)(".diff-table",function(e){let t=null;function n(){t&&e5(t,!1),t=null}function r(e){t&&e5(t,!1),e.target instanceof HTMLElement&&(t=e.target.closest("td.blob-code"))&&e5(t,!0)}return{add:function(){e.addEventListener("mouseenter",n),e.addEventListener("mouseleave",n),e.addEventListener("mouseover",r)},remove:function(){e.removeEventListener("mouseenter",n),e.removeEventListener("mouseleave",n),e.removeEventListener("mouseover",r)}}}),(0,a.lB)(".js-diff-container",function(){return{add:function(){document.addEventListener("copy",e7),document.addEventListener("mousedown",e3),document.addEventListener("selectionchange",e9)},remove:function(){document.removeEventListener("copy",e7),document.removeEventListener("mousedown",e3),document.removeEventListener("selectionchange",e9)}}}),n(66914),(0,a.lB)("meta[name=diff-view]",{add:e2,remove:e2}),(0,a.lB)(".js-file-diff-split",{add:e2,remove:e2}),(0,a.lB)(".js-compare-tab.selected",{add:e2,remove:e2}),(0,a.lB)(".wants-full-width-container",{add:e2,remove:e2}),(0,o.on)("change",".js-toggle-file-notes",function(e){let t=e.currentTarget;t.closest(".file").classList.toggle("show-inline-notes",t.checked)}),(0,o.on)("click",".js-toggle-all-file-notes",function(e){e4(Array.from(document.querySelectorAll(".js-toggle-file-notes"))),e.preventDefault()}),(0,o.on)("click",".js-toggle-all-file-annotations",function(e){e4(Array.from(document.querySelectorAll(".js-toggle-file-check-annotations"))),e.preventDefault()}),(0,a.lB)(".js-inline-comments-container",function(e){let t,n=e.closest(".file");if(n)return{add:t=function(){let e=null!=n.querySelector(".js-inline-comments-container");n.classList.toggle("has-inline-notes",e)},remove:t}}),(0,o.on)("change",".js-toggle-file-check-annotations",function(e){let t=e.currentTarget;for(let e of t.closest(".file").querySelectorAll(".js-inline-annotations"))e instanceof HTMLElement&&(e.hidden=!t.checked)});let DiffFileFilterElement=class DiffFileFilterElement extends HTMLElement{connectedCallback(){this.filterState={hideDeletedFiles:!1,hideViewedFiles:!1,showManifestFilesOnly:!1,selectedOwners:[],showCodeownersFiles:!1,selectedFileTypes:[],fileTypeFilterActive:!1,filtersActive:!1}}applyFilter(e){this.filterState=e.detail,this.showResetFilters(),this.filterFiles(),this.filterTreeFiles(),this.hideEmptyDirectories(),this.showBlankslateIfEmpty()}clearFilters(e){e.preventDefault(),this.fileFilter.clearFilters()}filterFiles(){for(let e of this.diffEntries)e.closest(".js-file.js-details-container").hidden=!this.shouldShowFile(e)}filterTreeFiles(){for(let e of this.treeEntries){let t=this.shouldShowFile(e);e.hidden=!t,e.toggleAttribute("data-skip-substring-filter",!t)}}hideEmptyDirectories(){this.treeRoot&&this.hideEmptyDirectory(this.treeRoot)}hideEmptyDirectory(e){let t="root"===e.getAttribute("data-tree-entry-type"),n="directory"===e.getAttribute("data-tree-entry-type");if(t||n){let n=e.querySelectorAll(t?":scope > .js-tree-node":":scope > ul > .js-tree-node"),r=0;for(let e of n)r+=this.hideEmptyDirectory(e);return 0===r?(e.hidden=!0,0):(e.hidden=!1,1)}return+!e.hidden}async refilterAfterAsyncLoad(){await Promise.resolve(),this.refilterLoadedFiles(),this.showBlankslateIfEmpty()}refilterLoadedFiles(){this.filterState.filtersActive&&this.filterFiles()}shouldShowFile(e){let t=!0,n=e.getAttribute("data-file-type");return n&&(t=this.filterState.selectedFileTypes.includes(n)),this.filterState.hideViewedFiles&&t&&e.hasAttribute("data-file-user-viewed")&&(t=!1),this.filterState.showCodeownersFiles&&t&&(t=(e.getAttribute("data-codeowners")||"").split(",").filter(e=>this.filterState.selectedOwners.includes(e)).length>0),this.filterState.hideDeletedFiles&&t&&"true"===e.getAttribute("data-file-deleted")&&(t=!1),this.filterState.showManifestFilesOnly&&t&&(e.hasAttribute("data-file-manifest")||(t=!1)),t}showResetFilters(){this.resetFilters&&(this.resetFilters.hidden=!this.filterState.filtersActive)}showBlankslateIfEmpty(){if(!this.blankslate)return;if(this.progressiveLoaders.length>0||0===this.diffEntries.length){this.blankslate.hidden=!0;return}let e=Array.from(this.diffEntries).some(e=>!e.hidden);this.blankslate.hidden=e}};(0,eS.Cg)([eq.aC],DiffFileFilterElement.prototype,"blankslate",void 0),(0,eS.Cg)([eq.aC],DiffFileFilterElement.prototype,"resetFilters",void 0),(0,eS.Cg)([eq.zV],DiffFileFilterElement.prototype,"diffEntries",void 0),(0,eS.Cg)([eq.zV],DiffFileFilterElement.prototype,"progressiveLoaders",void 0),(0,eS.Cg)([eq.zV],DiffFileFilterElement.prototype,"treeEntries",void 0),(0,eS.Cg)([eq.aC],DiffFileFilterElement.prototype,"treeRoot",void 0),(0,eS.Cg)([eq.aC],DiffFileFilterElement.prototype,"fileFilter",void 0),(0,eS.Cg)([(0,ew.s)(20)],DiffFileFilterElement.prototype,"hideEmptyDirectories",null),DiffFileFilterElement=(0,eS.Cg)([eq.p_],DiffFileFilterElement);var e8=n(70987);let e6=class InputDemuxBaseChangeContext{onItemSelected(e){if(!(e.currentTarget instanceof HTMLButtonElement))return;let t=e.currentTarget.querySelector(".js-ref-name").textContent;document.querySelector(".js-new-base-branch").value=btoa(unescape(encodeURIComponent(t||"")));let n=document.querySelector(".js-change-base-template").content.cloneNode(!0);n instanceof DocumentFragment&&(0,e8.r)({content:n})}},te=class InputDemuxContextWrapperElement extends HTMLElement{connectedCallback(){let e=this.getAttribute("data-context-type"),t={baseChange:new e6};this.context=t[e]}onItemSelected(e){this.context.onItemSelected(e)}};te=(0,eS.Cg)([eq.p_],te),n(18962),n(90787),n(39857),n(50502)}},e=>{e.O(0,[43784,17688,2869,7332,39713,30037,72568,39276,51519,90787,27376,55526],()=>e(e.s=57001)),e.O()}]);
//# sourceMappingURL=diffs-b16785bbed72.js.map